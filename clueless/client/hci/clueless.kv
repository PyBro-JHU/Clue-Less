#:kivy 1.0
#:import kivy kivy
#:import WipeTransition kivy.uix.screenmanager.WipeTransition
#:import game_state clueless.model
                
<StartScreen>:
    username: user_name
    suspect: suspect_selected
    
    canvas:
        Color:
            rgb: 0, 0, 0
    GridLayout:
        cols: 2
        rows: 1
        row_force_default: True
        row_default_height: 250
        Image:
            size_hint: 1, 1
            source: 'resources/pyBro_logo.png'
        GridLayout:
            cols: 2
            row_force_default: True
            row_default_height: 35
            padding: '20dp'
            spacing: '10dp'
            Label:
                size_hint: 1, 1
                text: 'Username'
            TextInput:
                id: user_name
                multiline: False
                size_hint: 1, 1
                text: 'TestUser'
            Label:
                text: 'Select Suspect:'
            Spinner:
                id: suspect_selected
                size_hint_y: None
                height: 34
                text: 'Miss Scarlet'
                values: 'Miss Scarlet', 'Colonel Mustard', 'Professor Plum', 'Mr Green', 'Mrs White', 'Mrs Peacock'
            Label:
                text: ''                
            Label:
                text: ''                
            Button:
                size_hint_y: None
                height: 34
                text: 'Play!'
                on_release: root.register_player()

<GameScreen>:
    gameboard: gameboard
    controls: controls
    user: _user
    
    canvas:
        Color:
            rgb: 1, 1, 1
        Rectangle:
            source: 'resources/background.jpg'
            size: self.size

    BoxLayout:
        orientation: 'vertical'

        BoxLayout:
            orientation: 'horizontal'
            padding: '10dp'
            spacing: '10dp'
            size_hint: 1, None
            pos_hint: {'top': 1}
            height: '44dp'
            Image:
                size_hint: None, None
                size: '24dp', '24dp'
                source: 'resources/pyBro_logo.png'
                mipmap: True
            Label:
                height: '24dp'
                text_size: self.width, None
                color: (1, 1, 1, .8)
                text: 'PyBro - Clue-less %s' % '0.1.0'
            Label:
                id: _user
                height: '24p'
                text_size: self.width, None
                color: (1, 1, 1, .8)
            Button:
                size_hint_x: None
                width: 60
                text: 'Help'
                on_release: root.display_help()
            Button:
                size_hint_x: None
                width: 60
                text: 'Quit'
                on_release: root.quit_game()

        BoxLayout:
            orientation: 'horizontal'
            Gameboard:
                id: gameboard
                size_hint: 1, 1
            ControlPanel:
                id: controls

<GameTile>
    background_down: 'resources/pyBro_logo.png'
    center: self.center

<Gameboard>:
    study: study_0
    study_hall: hallway_1
    hall: hall_2
    hall_lounge: hallway_3
    lounge: lounge_4
    study_library: hallway_5
    study_billiard: secret_passage_6
    hall_billiard: hallway_7
    lounge_billiard: secret_passage_8
    lounge_dining: hallway_9
    library: library_10
    library_billiard: hallway_11
    billiard_room: billiard_room_12
    billiard_dining: hallway_13
    dining_room: dining_room_14
    library_conservatory: hallway_15
    conservatory_billiard: secret_passage_16
    billiard_ballroom: hallway_17
    kitchen_billiard: secret_passage_18
    dining_kitchen: hallway_19
    conservatory: conservatory_20
    conservatory_ballroom: hallway_21
    ballroom: ballroom_22
    ballroom_kitchen: hallway_23
    kitchen: kitchen_24
    
    GridLayout:
        cols: 5
        GameTile:
            id: study_0
            text: 'Study'
            background_normal: 'resources/study.png'
            on_release: root.make_move('Study')
        GameTile:
            id: hallway_1
            background_normal: 'resources/hallway_horizontal.png'
            on_release: root.make_move('study-hall hallway')
        GameTile:
            id: hall_2
            text: 'Hall'
            background_normal: 'resources/hall.png'
            on_release: root.make_move('Hall')
        GameTile:
            id: hallway_3
            background_normal: 'resources/hallway_horizontal.png'
            on_release: root.make_move('hall-lounge hallway')
        GameTile:
            id: lounge_4
            text: 'Lounge'
            background_normal: 'resources/lounge.png'
            on_release: root.make_move('Lounge')
        GameTile:
            id: hallway_5
            background_normal: 'resources/hallway_vertical.png'
            on_release: root.make_move('study-library hallway')
        GameTile:
            id: secret_passage_6
            background_normal: 'resources/pyBro_logo-gray.jpg'
            disabled: True
        GameTile:
            id: hallway_7
            background_normal: 'resources/hallway_vertical.png'
            on_release: root.make_move('hall-billiard hallway')
        GameTile:
            id: secret_passage_8
            background_normal: 'resources/pyBro_logo-gray.jpg'
            disabled: True
        GameTile:
            id: hallway_9
            background_normal: 'resources/hallway_vertical.png'
            on_release: root.make_move('lounge-dining hallway')
        GameTile:
            id: library_10
            text: 'Library'
            background_normal: 'resources/library.png'
            on_release: root.make_move('Library')
        GameTile:
            id: hallway_11
            background_normal: 'resources/hallway_horizontal.png'
            on_release: root.make_move('library-billiard hallway')
        GameTile:
            id: billiard_room_12
            text: 'Billiard Room'
            background_normal: 'resources/billiards_room.png'
            on_release: root.make_move('Billiard Room')
        GameTile:
            id: hallway_13
            background_normal: 'resources/hallway_horizontal.png'
            on_release: root.make_move('billiard-dining hallway')
        GameTile:
            id: dining_room_14
            text: 'Dining Room'
            background_normal: 'resources/dining_room.png'
            on_release: root.make_move('Dining Room')
        GameTile:
            id: hallway_15
            background_normal: 'resources/hallway_vertical.png'
            on_release: root.make_move('library-conservatory hallway')
        GameTile:
            id: secret_passage_16
            background_normal: 'resources/pyBro_logo-gray.jpg'
            disabled: True
        GameTile:
            id: hallway_17
            background_normal: 'resources/hallway_vertical.png'
            on_release: root.make_move('billiard-ballroom hallway')
        GameTile:
            id: secret_passage_18
            background_normal: 'resources/pyBro_logo-gray.jpg'
            disabled: True
        GameTile:
            id: hallway_19
            background_normal: 'resources/hallway_vertical.png'
            on_release: root.make_move('dining-kitchen hallway')
        GameTile:
            id: conservatory_20
            text: 'Conservatory'
            background_normal: 'resources/conservatory.png'
            on_release: root.make_move('Conservatory')
        GameTile:
            id: hallway_21
            background_normal: 'resources/hallway_horizontal.png'
            on_release: root.make_move('conservatory-ballroom hallway')
        GameTile:
            id: ballroom_22
            text: 'Ballroom'
            background_normal: 'resources/ballroom.png'
            on_release: root.make_move('Ballroom')
        GameTile:
            id: hallway_23
            background_normal: 'resources/hallway_horizontal.png'
            on_release: root.make_move('ballroom-kitchen hallway')
        GameTile:
            id: kitchen_24
            text: 'Kitchen'
            background_normal: 'resources/kitchen.png'
            on_release: root.make_move('Kitchen')
    
<ControlPanel>:
    notifications: notification_text
    notepad: notepad_input
    suggest_button: _suggest_button
    accuse_button: _accuse_button
    end_turn_button: _end_turn_button
    
    BoxLayout:
        orientation: 'vertical'
        padding: 5
        spacing: 5

        Label:
            size_hint_y: 0.1
            pos_hint: {'x': 1}
            text: 'Notifications'
                
        TextInput:
            id: notification_text
            size_hint_y: 1.5
            pos_hint: {'x': 1}
        
        Label:
            size_hint_y: 0.1
            pos_hint: {'x': 1}
            text: 'Detective Notebook'
             
        TextInput:
            id: notepad_input
            size_hint_y: 1.5
            pos_hint: {'x': 1}

        BoxLayout:
            orientation: 'horizontal'
            pos_hint: {'x': 1}
            padding: 5
            spacing: 5
            DisableButton:
                id: _suggest_button
                text: 'Suggest'
                on_release: root.suggest_popup()
            DisableButton:
                id: _accuse_button
                text: 'Accuse'
                on_release: root.accuse_popup()
            DisableButton:
                id: _end_turn_button
                text: 'End Turn'
                on_release: root.end_turn()

<AccusationPopup>:
    suspect: _suspect
    room: _room
    weapon: _weapon
    
    auto_dismiss: False
    title: 'Accusation'
    size_hint: None, None
    size: '500dp', '300dp'
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'Select a Suspect, Room, and Weapon to make an Accusation.'
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            Spinner:
                id: _suspect
                size_hint_y: None
                height: 34
                text: 'Suspect'
                values: 'Miss Scarlet', 'Colonel Mustard', 'Professor Plum', 'Mr Green', 'Mrs White', 'Mrs Peacock'
            Spinner:
                id: _room
                size_hint_y: None
                height: 34
                text: 'Room'
                values: 'Study', 'Hall', 'Lounge', 'Library', 'Billiard Room', 'Dining Room', 'Conservatory', 'Ballroom', 'Kitchen'
            Spinner:
                id: _weapon
                size_hint_y: None
                height: 34
                text: 'Weapon'
                values: 'Rope', 'Lead Pipe', 'Knife', 'Wrench', 'Candlestick', 'Revolver'
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            Button:
                text: 'Make Accusation'
                size_hint_y: None
                height: '50sp'
                on_release: root.confirm_popup()
            Button:
                text: 'Cancel'
                size_hint_y: None
                height: '50sp'
                on_release: root.dismiss()
                    
<AccusationConfirmPopup>:
    auto_dismiss: True
    title: 'Confirm Accusation'
    size_hint: None, None
    size: '500dp', '300dp'
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        Label:
            text: 'Are you sure that you want to make an Accusation?'
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            Button:
                text: 'Accuse'
                size_hint_y: None
                height: '50sp'
                on_release: root.make_accusation()
            Button:
                text: 'Cancel'
                size_hint_y: None
                height: '50sp'
                on_release: root.dismiss()
                
<SuggestionPopup>:
    suspect: _suspect
    weapon: _weapon
    
    auto_dismiss: False
    title: 'Suggestion'
    size_hint: None, None
    size: '500dp', '300dp'
    BoxLayout:
        orientation: 'vertical'
        Label:
            text: 'Select a Suspect and Weapon to make a Suggestion.'
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            Spinner:
                id: _suspect
                size_hint_y: None
                height: 34
                text: 'Suspect'
                values: 'Miss Scarlet', 'Colonel Mustard', 'Professor Plum', 'Mr Green', 'Mrs White', 'Mrs Peacock'
            Spinner:
                id: _weapon
                size_hint_y: None
                height: 34
                text: 'Weapon'
                values: 'Rope', 'Lead Pipe', 'Knife', 'Wrench', 'Candlestick', 'Revolver'
        BoxLayout:
            orientation: 'horizontal'
            padding: 5
            spacing: 5
            Button:
                text: 'Make Suggestion'
                size_hint_y: None
                height: '50sp'
                on_release: root.make_suggestion()
            Button:
                text: 'Cancel'
                size_hint_y: None
                height: '50sp'
                on_release: root.dismiss()
                
<SuggestionResponsePopup>:
    card: _card
    
    auto_dismiss: False
    title: 'Prove Suggestion False'
    size_hint: None, None
    size: '300dp', '300dp'
    BoxLayout:
        orientation: 'vertical'
        padding: 10
        spacing: 10
        Label:
            text: 'Select a card to disprove the Suggestion.'
        Spinner:
            id: _card
            size_hint_y: None
            height: 34
            text: 'Card'
        Button:
            text: 'Submit'
            size_hint_y: None
            height: '50sp'
            on_release: root.disprove_suggestion()
                
<ErrorPopup>:
    message: _message
    auto_dismiss: True
    size_hint: None, None
    size: '500dp', '300dp'
    title: 'Clue-Less Information'
    BoxLayout:
        orientation: 'vertical'
        Label:
            id: _message
        Button:
            text: 'OK'
            size_hint_y: None
            height: '50sp'
            on_press: root.dismiss()
                    